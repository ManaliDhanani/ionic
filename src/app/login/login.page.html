<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-menu-button></ion-menu-button>
    </ion-buttons>
    <ion-title>Login</ion-title>
  </ion-toolbar>
</ion-header>

<ion-progress-bar *ngIf="isLoading" type="indeterminate"></ion-progress-bar>

<ion-content>
  <ion-refresher slot="fixed" (ionRefresh)="handleRefresh($event)">
    <ion-refresher-content></ion-refresher-content>
  </ion-refresher>
  <div id="container">
    <ion-card>
      <div class="wrapper">
        <!-- <ion-range aria-label="Range with pin" [pin]="true" [pinFormatter]="pinFormatter"></ion-range> -->
        <h1 class="heading">Login</h1>
        <form [formGroup]="loginForm" (ngSubmit)="onFormSubmit()">

          <ion-list>
            <ion-item>
              <ion-input 
                label="Email" 
                formControlName="email" 
                labelPlacement="floating" 
                placeholder="Enter email">
              </ion-input>

              <ion-icon 
                name="alert-circle" 
                slot="end" 
                *ngIf="loginForm.get('email').invalid && (loginForm.get('email').dirty || submitted)">
              </ion-icon>
            </ion-item>

            <ion-text color="danger" *ngIf="loginForm.get('email').invalid && (loginForm.get('email').dirty || submitted)">
              <p *ngIf="loginForm.get('email').hasError('required')">*Email is required</p>
              <p *ngIf="loginForm.get('email').hasError('email')">*Invalid email format</p>
            </ion-text>

            <ion-item>
              <ion-input 
                #passwordInput 
                formControlName="password" 
                type="password" 
                label="Password" 
                labelPlacement="floating" 
                placeholder="Enter password">
              </ion-input>

              <ion-icon 
                [name]="passwordInput.type === 'password' ? 'eye' : 'eye-off'" 
                (click)="togglePasswordVisibility(passwordInput)" 
                slot="end"
                class="small-icon"
                color="primary">
              </ion-icon>

              <ion-icon 
                name="alert-circle" 
                slot="end" 
                *ngIf="loginForm.get('password').invalid && (loginForm.get('password').dirty || submitted)">
              </ion-icon>
            </ion-item>

            <ion-text color="danger" *ngIf="loginForm.get('password').invalid && (loginForm.get('password').dirty || submitted)">
              <p *ngIf="loginForm.get('password').hasError('required')">*Password is required</p>
            </ion-text>

            <ion-button type="submit" class="loginButton" expand="block" [disabled]="isLoading">
              Login
              <ion-spinner *ngIf="isLoading" name="circular" style="margin-left: 1rem;"></ion-spinner>
            </ion-button>
          </ion-list>

        </form>
      </div>

    </ion-card>
  </div>
</ion-content>